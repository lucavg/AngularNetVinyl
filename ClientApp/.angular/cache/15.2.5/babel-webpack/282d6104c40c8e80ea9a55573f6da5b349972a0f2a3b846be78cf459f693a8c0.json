{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport { forkJoin, switchMap, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/collection.service\";\nimport * as i2 from \"../services/spotify.service\";\nimport * as i3 from \"../services/refresh.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"../components/full-album/full-album.component\";\nfunction CollectionComponent_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 4)(2, \"div\", 5);\n    i0.ɵɵtext(3, \"No albums found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 6);\n    i0.ɵɵtext(5, \" Try adding some albums to your collection! \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction CollectionComponent_ng_container_4_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵelement(1, \"app-full-album\", 14);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const album_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"album\", album_r4);\n  }\n}\nfunction CollectionComponent_ng_container_4_li_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\")(1, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_li_11_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const page_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.setCurrentPage(page_r5));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const page_r5 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", ctx_r3.currentPage === page_r5);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", page_r5, \" \");\n  }\n}\nfunction CollectionComponent_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 7);\n    i0.ɵɵtemplate(2, CollectionComponent_ng_container_4_div_2_Template, 2, 1, \"div\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9)(4, \"ul\", 10)(5, \"li\")(6, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.setCurrentPage(1));\n    });\n    i0.ɵɵtext(7, \" First \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"li\")(9, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.setCurrentPage(ctx_r10.currentPage - 1));\n    });\n    i0.ɵɵtext(10, \" Previous \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(11, CollectionComponent_ng_container_4_li_11_Template, 3, 3, \"li\", 12);\n    i0.ɵɵelementStart(12, \"li\")(13, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.setCurrentPage(ctx_r11.currentPage + 1));\n    });\n    i0.ɵɵtext(14, \" Next \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"li\")(16, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.setCurrentPage(ctx_r12.totalPages.length));\n    });\n    i0.ɵɵtext(17, \" Last \");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.visibleAlbums);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.getIterable(ctx_r1.totalPages));\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === ctx_r1.totalPages.length);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === ctx_r1.totalPages.length);\n  }\n}\nexport class CollectionComponent {\n  constructor(collectionService, spotifyService, refreshService) {\n    this.collectionService = collectionService;\n    this.spotifyService = spotifyService;\n    this.refreshService = refreshService;\n    this.albums = [];\n    this.filteredAlbums = [];\n    this.searchControl = new FormControl('');\n    this.currentPage = 1;\n    this.itemsPerPage = 9;\n    this.collectionId = localStorage.getItem('collectionId');\n    this.loading = true;\n  }\n  ngOnInit() {\n    this.refreshService.refresh$.subscribe(() => {\n      this.loadData();\n      this.searchControl.valueChanges.subscribe(searchTerm => {\n        this.filterAlbums(searchTerm);\n      });\n    });\n    this.loadData();\n    this.searchControl.valueChanges.subscribe(searchTerm => {\n      this.filterAlbums(searchTerm);\n    });\n  }\n  loadData() {\n    this.loadCollection().subscribe(() => {\n      this.filteredAlbums = this.albums;\n      this.filterAlbums(this.searchControl.value);\n      this.loading = false; // Set loading to false after all albums are loaded\n    });\n  }\n\n  loadCollection() {\n    return this.collectionService.getCollection(this.collectionId).pipe(switchMap(collection => {\n      const albumIds = collection.albums.map(album => album.id);\n      const albumRequests = albumIds.map(albumId => this.spotifyService.getAlbum(albumId));\n      return forkJoin(albumRequests).pipe(tap(albums => {\n        this.albums = albums;\n      }));\n    }));\n  }\n  filterAlbums(searchTerm) {\n    const filtered = this.albums.filter(album => album.name.toLowerCase().includes(searchTerm.toLowerCase()) || album.artists.length > 0 && album.artists[0].name.toLowerCase().includes(searchTerm.toLowerCase()));\n    this.filteredAlbums = filtered;\n    this.currentPage = 1;\n  }\n  get totalPages() {\n    var totalPages = [];\n    const totalAlbums = Math.ceil(this.albums.length / this.itemsPerPage);\n    totalPages = Array(totalAlbums).fill(0).map((_, index) => index + 1);\n    return totalPages;\n  }\n  get visibleAlbums() {\n    const startIndex = (this.currentPage - 1) * this.itemsPerPage;\n    return this.filteredAlbums.slice(startIndex, startIndex + this.itemsPerPage);\n  }\n  setCurrentPage(page) {\n    if (page >= 1 && page <= this.totalPages.length) {\n      this.currentPage = page;\n    }\n  }\n  getIterable(value) {\n    return Array.isArray(value) ? value : Array.from({\n      length: value\n    });\n  }\n}\nCollectionComponent.ɵfac = function CollectionComponent_Factory(t) {\n  return new (t || CollectionComponent)(i0.ɵɵdirectiveInject(i1.CollectionService), i0.ɵɵdirectiveInject(i2.SpotifyService), i0.ɵɵdirectiveInject(i3.RefreshService));\n};\nCollectionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CollectionComponent,\n  selectors: [[\"app-collection\"]],\n  decls: 5,\n  vars: 3,\n  consts: [[1, \"container\", \"mx-auto\"], [1, \"mb-4\"], [\"type\", \"text\", \"placeholder\", \"Search albums\", 1, \"w-full\", \"px-4\", \"py-2\", \"border\", \"rounded-md\", 3, \"formControl\"], [4, \"ngIf\"], [1, \"flex\", \"flex-col\", \"items-center\", \"justify-center\", \"h-64\"], [1, \"text-2xl\", \"font-bold\"], [1, \"text-gray-500\"], [1, \"grid\", \"grid-cols-1\", \"sm:grid-cols-2\", \"md:grid-cols-3\", \"gap-4\"], [\"class\", \"flex flex-col\", 4, \"ngFor\", \"ngForOf\"], [1, \"mt-4\"], [1, \"flex\", \"justify-center\", \"space-x-2\"], [1, \"btn-pagination\", 3, \"click\"], [3, \"active\", 4, \"ngFor\", \"ngForOf\"], [1, \"flex\", \"flex-col\"], [3, \"album\"]],\n  template: function CollectionComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n      i0.ɵɵelement(2, \"input\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(3, CollectionComponent_ng_container_3_Template, 6, 0, \"ng-container\", 3);\n      i0.ɵɵtemplate(4, CollectionComponent_ng_container_4_Template, 18, 10, \"ng-container\", 3);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formControl\", ctx.searchControl);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.visibleAlbums.length == 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.visibleAlbums.length != 0);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.FormControlDirective, i6.FullAlbumComponent],\n  styles: [\".btn-pagination[_ngcontent-%COMP%] {\\r\\n  padding: 0.5rem 1rem;\\r\\n  background-color: #4a5568;\\r\\n  color: #ffffff;\\r\\n  border: none;\\r\\n  border-radius: 0.25rem;\\r\\n  cursor: pointer;\\r\\n  transition: background-color 0.3s;\\r\\n}\\r\\n\\r\\n.btn-pagination[_ngcontent-%COMP%]:hover {\\r\\n  background-color: #718096;\\r\\n}\\r\\n\\r\\n.btn-pagination.disabled[_ngcontent-%COMP%] {\\r\\n  opacity: 0.5;\\r\\n  cursor: not-allowed;\\r\\n}\\r\\n\\r\\n.btn-pagination.active[_ngcontent-%COMP%] {\\r\\n  background-color: #2c5282;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGxlY3Rpb24uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLG9CQUFvQjtFQUNwQix5QkFBeUI7RUFDekIsY0FBYztFQUNkLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsZUFBZTtFQUNmLGlDQUFpQztBQUNuQzs7QUFFQTtFQUNFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLFlBQVk7RUFDWixtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0IiLCJmaWxlIjoiY29sbGVjdGlvbi5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmJ0bi1wYWdpbmF0aW9uIHtcclxuICBwYWRkaW5nOiAwLjVyZW0gMXJlbTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGE1NTY4O1xyXG4gIGNvbG9yOiAjZmZmZmZmO1xyXG4gIGJvcmRlcjogbm9uZTtcclxuICBib3JkZXItcmFkaXVzOiAwLjI1cmVtO1xyXG4gIGN1cnNvcjogcG9pbnRlcjtcclxuICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3M7XHJcbn1cclxuXHJcbi5idG4tcGFnaW5hdGlvbjpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzcxODA5NjtcclxufVxyXG5cclxuLmJ0bi1wYWdpbmF0aW9uLmRpc2FibGVkIHtcclxuICBvcGFjaXR5OiAwLjU7XHJcbiAgY3Vyc29yOiBub3QtYWxsb3dlZDtcclxufVxyXG5cclxuLmJ0bi1wYWdpbmF0aW9uLmFjdGl2ZSB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzJjNTI4MjtcclxufVxyXG4iXX0= */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29sbGVjdGlvbi9jb2xsZWN0aW9uLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxvQkFBb0I7RUFDcEIseUJBQXlCO0VBQ3pCLGNBQWM7RUFDZCxZQUFZO0VBQ1osc0JBQXNCO0VBQ3RCLGVBQWU7RUFDZixpQ0FBaUM7QUFDbkM7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSxZQUFZO0VBQ1osbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UseUJBQXlCO0FBQzNCOztBQUVBLG9oQ0FBb2hDIiwic291cmNlc0NvbnRlbnQiOlsiLmJ0bi1wYWdpbmF0aW9uIHtcclxuICBwYWRkaW5nOiAwLjVyZW0gMXJlbTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGE1NTY4O1xyXG4gIGNvbG9yOiAjZmZmZmZmO1xyXG4gIGJvcmRlcjogbm9uZTtcclxuICBib3JkZXItcmFkaXVzOiAwLjI1cmVtO1xyXG4gIGN1cnNvcjogcG9pbnRlcjtcclxuICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3M7XHJcbn1cclxuXHJcbi5idG4tcGFnaW5hdGlvbjpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzcxODA5NjtcclxufVxyXG5cclxuLmJ0bi1wYWdpbmF0aW9uLmRpc2FibGVkIHtcclxuICBvcGFjaXR5OiAwLjU7XHJcbiAgY3Vyc29yOiBub3QtYWxsb3dlZDtcclxufVxyXG5cclxuLmJ0bi1wYWdpbmF0aW9uLmFjdGl2ZSB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzJjNTI4MjtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"AACA,SAASA,WAAW,QAAQ,gBAAgB;AAK5C,SAAqBC,QAAQ,EAAEC,SAAS,EAAEC,GAAG,QAAQ,MAAM;;;;;;;;;;ICGzDC,6BAAgD;IAC9CA,8BAA4D;IAC1BA,+BAAe;IAAAA,iBAAM;IACrDA,8BAA2B;IACzBA,4DACF;IAAAA,iBAAM;IAEVA,0BAAe;;;;;IAGXA,+BAA+D;IAC7DA,qCAAkD;IACpDA,iBAAM;;;;IADYA,eAAe;IAAfA,gCAAe;;;;;;IAuB/BA,0BAGC;IACgCA;MAAA;MAAA;MAAA;MAAA,OAASA,6CAAoB;IAAA,EAAC;IAC3DA,YACF;IAAAA,iBAAS;;;;;IAJTA,wDAAqC;IAGnCA,eACF;IADEA,wCACF;;;;;;IAhCRA,6BAAgD;IAC9CA,8BAAkE;IAChEA,mFAEM;IACRA,iBAAM;IACNA,8BAAkB;IAMVA;MAAAA;MAAA;MAAA,OAASA,qCAAe,CAAC,CAAC;IAAA,EAAC;IAE3BA,uBACF;IAAAA,iBAAS;IAEXA,0BAAI;IAIAA;MAAAA;MAAA;MAAA,OAASA,4DAA6B,CAAC,CAAC;IAAA,EAAC;IAEzCA,2BACF;IAAAA,iBAAS;IAEXA,oFAOK;IACLA,2BAAI;IAIAA;MAAAA;MAAA;MAAA,OAASA,4DAA6B,CAAC,CAAC;IAAA,EAAC;IAEzCA,uBACF;IAAAA,iBAAS;IAEXA,2BAAI;IAIAA;MAAAA;MAAA;MAAA,OAASA,gEAAiC;IAAA,EAAC;IAE3CA,uBACF;IAAAA,iBAAS;IAIjBA,0BAAe;;;;IApDkCA,eAAgB;IAAhBA,8CAAgB;IASvDA,eAAoC;IAApCA,oDAAoC;IASpCA,eAAoC;IAApCA,oDAAoC;IAOrBA,eAA0B;IAA1BA,+DAA0B;IAUzCA,eAAoD;IAApDA,2EAAoD;IASpDA,eAAoD;IAApDA,2EAAoD;;;ADjDhE,OAAM,MAAOC,mBAAmB;EAS9BC,YACUC,iBAAoC,EACpCC,cAA8B,EAC9BC,cAA8B;IAF9B,sBAAiB,GAAjBF,iBAAiB;IACjB,mBAAc,GAAdC,cAAc;IACd,mBAAc,GAAdC,cAAc;IAXxB,WAAM,GAAoB,EAAE;IAC5B,mBAAc,GAAoB,EAAE;IACpC,kBAAa,GAAG,IAAIT,WAAW,CAAC,EAAE,CAAC;IACnC,gBAAW,GAAG,CAAC;IACf,iBAAY,GAAG,CAAC;IAChB,iBAAY,GAAGU,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IACnD,YAAO,GAAG,IAAI;EAMX;EAEHC,QAAQ;IACN,IAAI,CAACH,cAAc,CAACI,QAAQ,CAACC,SAAS,CAAC,MAAK;MAC1C,IAAI,CAACC,QAAQ,EAAE;MACf,IAAI,CAACC,aAAa,CAACC,YAAY,CAACH,SAAS,CAAEI,UAAU,IAAI;QACvD,IAAI,CAACC,YAAY,CAACD,UAAW,CAAC;MAChC,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,IAAI,CAACH,QAAQ,EAAE;IACf,IAAI,CAACC,aAAa,CAACC,YAAY,CAACH,SAAS,CAAEI,UAAU,IAAI;MACvD,IAAI,CAACC,YAAY,CAACD,UAAW,CAAC;IAChC,CAAC,CAAC;EACJ;EAEAH,QAAQ;IACN,IAAI,CAACK,cAAc,EAAE,CAACN,SAAS,CAAC,MAAK;MACnC,IAAI,CAACO,cAAc,GAAG,IAAI,CAACC,MAAM;MACjC,IAAI,CAACH,YAAY,CAAC,IAAI,CAACH,aAAa,CAACO,KAAM,CAAC;MAC5C,IAAI,CAACC,OAAO,GAAG,KAAK,CAAC,CAAC;IACxB,CAAC,CAAC;EACJ;;EAEAJ,cAAc;IACZ,OAAO,IAAI,CAACb,iBAAiB,CAACkB,aAAa,CAAC,IAAI,CAACC,YAAa,CAAC,CAACC,IAAI,CAClEzB,SAAS,CAAE0B,UAAU,IAAI;MACvB,MAAMC,QAAQ,GAAGD,UAAU,CAACN,MAAM,CAACQ,GAAG,CAAEC,KAAK,IAAKA,KAAK,CAACC,EAAE,CAAC;MAC3D,MAAMC,aAAa,GAAGJ,QAAQ,CAACC,GAAG,CAAEI,OAAO,IACzC,IAAI,CAAC1B,cAAc,CAAC2B,QAAQ,CAACD,OAAO,CAAC,CACtC;MAED,OAAOjC,QAAQ,CAACgC,aAAa,CAAC,CAACN,IAAI,CACjCxB,GAAG,CAAEmB,MAAM,IAAI;QACb,IAAI,CAACA,MAAM,GAAGA,MAAM;MACtB,CAAC,CAAC,CACH;IACH,CAAC,CAAC,CACH;EACH;EAEAH,YAAY,CAACD,UAAkB;IAC7B,MAAMkB,QAAQ,GAAG,IAAI,CAACd,MAAM,CAACe,MAAM,CAChCN,KAAK,IACJA,KAAK,CAACO,IAAI,CAACC,WAAW,EAAE,CAACC,QAAQ,CAACtB,UAAU,CAACqB,WAAW,EAAE,CAAC,IAC1DR,KAAK,CAACU,OAAO,CAACC,MAAM,GAAG,CAAC,IACvBX,KAAK,CAACU,OAAO,CAAC,CAAC,CAAC,CAACH,IAAI,CAClBC,WAAW,EAAE,CACbC,QAAQ,CAACtB,UAAU,CAACqB,WAAW,EAAE,CAAE,CAC3C;IACD,IAAI,CAAClB,cAAc,GAAGe,QAAQ;IAC9B,IAAI,CAACO,WAAW,GAAG,CAAC;EACtB;EAEA,IAAIC,UAAU;IACZ,IAAIA,UAAU,GAAa,EAAE;IAC7B,MAAMC,WAAW,GAAGC,IAAI,CAACC,IAAI,CAAC,IAAI,CAACzB,MAAM,CAACoB,MAAM,GAAG,IAAI,CAACM,YAAY,CAAC;IACrEJ,UAAU,GAAGK,KAAK,CAACJ,WAAW,CAAC,CAC5BK,IAAI,CAAC,CAAC,CAAC,CACPpB,GAAG,CAAC,CAACqB,CAAC,EAAEC,KAAK,KAAKA,KAAK,GAAG,CAAC,CAAC;IAC/B,OAAOR,UAAU;EACnB;EAEA,IAAIS,aAAa;IACf,MAAMC,UAAU,GAAG,CAAC,IAAI,CAACX,WAAW,GAAG,CAAC,IAAI,IAAI,CAACK,YAAY;IAC7D,OAAO,IAAI,CAAC3B,cAAc,CAACkC,KAAK,CAC9BD,UAAU,EACVA,UAAU,GAAG,IAAI,CAACN,YAAY,CAC/B;EACH;EAEAQ,cAAc,CAACC,IAAY;IACzB,IAAIA,IAAI,IAAI,CAAC,IAAIA,IAAI,IAAI,IAAI,CAACb,UAAU,CAACF,MAAM,EAAE;MAC/C,IAAI,CAACC,WAAW,GAAGc,IAAI;;EAE3B;EAEAC,WAAW,CAACnC,KAAU;IACpB,OAAO0B,KAAK,CAACU,OAAO,CAACpC,KAAK,CAAC,GAAGA,KAAK,GAAG0B,KAAK,CAACW,IAAI,CAAC;MAAElB,MAAM,EAAEnB;IAAK,CAAE,CAAC;EACrE;;AA5FWlB,mBAAmB;mBAAnBA,mBAAmB;AAAA;AAAnBA,mBAAmB;QAAnBA,mBAAmB;EAAAwD;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCdhC7D,8BAA+B;MAE3BA,2BAKE;MACJA,iBAAM;MACNA,sFAOe;MACfA,wFAsDe;MACjBA,iBAAM;;;MAlEAA,eAA6B;MAA7BA,+CAA6B;MAGlBA,eAA+B;MAA/BA,oDAA+B;MAQ/BA,eAA+B;MAA/BA,oDAA+B","names":["FormControl","forkJoin","switchMap","tap","i0","CollectionComponent","constructor","collectionService","spotifyService","refreshService","localStorage","getItem","ngOnInit","refresh$","subscribe","loadData","searchControl","valueChanges","searchTerm","filterAlbums","loadCollection","filteredAlbums","albums","value","loading","getCollection","collectionId","pipe","collection","albumIds","map","album","id","albumRequests","albumId","getAlbum","filtered","filter","name","toLowerCase","includes","artists","length","currentPage","totalPages","totalAlbums","Math","ceil","itemsPerPage","Array","fill","_","index","visibleAlbums","startIndex","slice","setCurrentPage","page","getIterable","isArray","from","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["D:\\AngularNetVinyl\\ClientApp\\src\\app\\collection\\collection.component.ts","D:\\AngularNetVinyl\\ClientApp\\src\\app\\collection\\collection.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { CollectionService } from '../services/collection.service';\nimport { AlbumResponse } from '../interfaces/Spotify/Search/AlbumResponse';\nimport { SpotifyService } from '../services/spotify.service';\nimport { AlbumComplete } from '../interfaces/Spotify/Search/AlbumComplete';\nimport { Observable, forkJoin, switchMap, tap } from 'rxjs';\nimport { RefreshService } from '../services/refresh.service';\n\n@Component({\n  selector: 'app-collection',\n  templateUrl: './collection.component.html',\n  styleUrls: ['./collection.component.css'],\n})\nexport class CollectionComponent implements OnInit {\n  albums: AlbumComplete[] = [];\n  filteredAlbums: AlbumComplete[] = [];\n  searchControl = new FormControl('');\n  currentPage = 1;\n  itemsPerPage = 9;\n  collectionId = localStorage.getItem('collectionId');\n  loading = true;\n\n  constructor(\n    private collectionService: CollectionService,\n    private spotifyService: SpotifyService,\n    private refreshService: RefreshService\n  ) {}\n\n  ngOnInit(): void {\n    this.refreshService.refresh$.subscribe(() => {\n      this.loadData();\n      this.searchControl.valueChanges.subscribe((searchTerm) => {\n        this.filterAlbums(searchTerm!);\n      });\n    });\n\n    this.loadData();\n    this.searchControl.valueChanges.subscribe((searchTerm) => {\n      this.filterAlbums(searchTerm!);\n    });\n  }\n\n  loadData(): void {\n    this.loadCollection().subscribe(() => {\n      this.filteredAlbums = this.albums;\n      this.filterAlbums(this.searchControl.value!);\n      this.loading = false; // Set loading to false after all albums are loaded\n    });\n  }\n\n  loadCollection(): Observable<AlbumComplete[]> {\n    return this.collectionService.getCollection(this.collectionId!).pipe(\n      switchMap((collection) => {\n        const albumIds = collection.albums.map((album) => album.id);\n        const albumRequests = albumIds.map((albumId) =>\n          this.spotifyService.getAlbum(albumId)\n        );\n\n        return forkJoin(albumRequests).pipe(\n          tap((albums) => {\n            this.albums = albums;\n          })\n        );\n      })\n    );\n  }\n\n  filterAlbums(searchTerm: string): void {\n    const filtered = this.albums.filter(\n      (album) =>\n        album.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        (album.artists.length > 0 &&\n          album.artists[0].name\n            .toLowerCase()\n            .includes(searchTerm.toLowerCase()))\n    );\n    this.filteredAlbums = filtered;\n    this.currentPage = 1;\n  }\n\n  get totalPages(): number[] {\n    var totalPages: number[] = [];\n    const totalAlbums = Math.ceil(this.albums.length / this.itemsPerPage);\n    totalPages = Array(totalAlbums)\n      .fill(0)\n      .map((_, index) => index + 1);\n    return totalPages;\n  }\n\n  get visibleAlbums(): AlbumComplete[] {\n    const startIndex = (this.currentPage - 1) * this.itemsPerPage;\n    return this.filteredAlbums.slice(\n      startIndex,\n      startIndex + this.itemsPerPage\n    );\n  }\n\n  setCurrentPage(page: number): void {\n    if (page >= 1 && page <= this.totalPages.length) {\n      this.currentPage = page;\n    }\n  }\n\n  getIterable(value: any): any[] {\n    return Array.isArray(value) ? value : Array.from({ length: value });\n  }\n}\n","<div class=\"container mx-auto\">\n  <div class=\"mb-4\">\n    <input\n      type=\"text\"\n      class=\"w-full px-4 py-2 border rounded-md\"\n      placeholder=\"Search albums\"\n      [formControl]=\"searchControl\"\n    />\n  </div>\n  <ng-container *ngIf=\"visibleAlbums.length == 0\">\n    <div class=\"flex flex-col items-center justify-center h-64\">\n      <div class=\"text-2xl font-bold\">No albums found</div>\n      <div class=\"text-gray-500\">\n        Try adding some albums to your collection!\n      </div>\n    </div>\n  </ng-container>\n  <ng-container *ngIf=\"visibleAlbums.length != 0\">\n    <div class=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4\">\n      <div class=\"flex flex-col\" *ngFor=\"let album of visibleAlbums\">\n        <app-full-album [album]=\"album\"> </app-full-album>\n      </div>\n    </div>\n    <div class=\"mt-4\">\n      <ul class=\"flex justify-center space-x-2\">\n        <li>\n          <button\n            class=\"btn-pagination\"\n            [class.disabled]=\"currentPage === 1\"\n            (click)=\"setCurrentPage(1)\"\n          >\n            First\n          </button>\n        </li>\n        <li>\n          <button\n            class=\"btn-pagination\"\n            [class.disabled]=\"currentPage === 1\"\n            (click)=\"setCurrentPage(currentPage - 1)\"\n          >\n            Previous\n          </button>\n        </li>\n        <li\n          *ngFor=\"let page of getIterable(totalPages)\"\n          [class.active]=\"currentPage === page\"\n        >\n          <button class=\"btn-pagination\" (click)=\"setCurrentPage(page)\">\n            {{ page }}\n          </button>\n        </li>\n        <li>\n          <button\n            class=\"btn-pagination\"\n            [class.disabled]=\"currentPage === totalPages.length\"\n            (click)=\"setCurrentPage(currentPage + 1)\"\n          >\n            Next\n          </button>\n        </li>\n        <li>\n          <button\n            class=\"btn-pagination\"\n            [class.disabled]=\"currentPage === totalPages.length\"\n            (click)=\"setCurrentPage(totalPages.length)\"\n          >\n            Last\n          </button>\n        </li>\n      </ul>\n    </div>\n  </ng-container>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}