{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport { forkJoin, switchMap, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/collection.service\";\nimport * as i2 from \"../services/spotify.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../components/full-album/full-album.component\";\nfunction CollectionComponent_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 4)(2, \"div\", 5);\n    i0.ɵɵtext(3, \"No albums found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 6);\n    i0.ɵɵtext(5, \" Try adding some albums to your collection! \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction CollectionComponent_ng_container_4_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵelement(1, \"app-full-album\", 14);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const album_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"album\", album_r4);\n  }\n}\nfunction CollectionComponent_ng_container_4_li_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\")(1, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_li_11_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const page_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.setCurrentPage(page_r5));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const page_r5 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", ctx_r3.currentPage === page_r5);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", page_r5, \" \");\n  }\n}\nfunction CollectionComponent_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 7);\n    i0.ɵɵtemplate(2, CollectionComponent_ng_container_4_div_2_Template, 2, 1, \"div\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9)(4, \"ul\", 10)(5, \"li\")(6, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.setCurrentPage(1));\n    });\n    i0.ɵɵtext(7, \" First \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"li\")(9, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.setCurrentPage(ctx_r10.currentPage - 1));\n    });\n    i0.ɵɵtext(10, \" Previous \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(11, CollectionComponent_ng_container_4_li_11_Template, 3, 3, \"li\", 12);\n    i0.ɵɵelementStart(12, \"li\")(13, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.setCurrentPage(ctx_r11.currentPage + 1));\n    });\n    i0.ɵɵtext(14, \" Next \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"li\")(16, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CollectionComponent_ng_container_4_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.setCurrentPage(ctx_r12.totalPages.length));\n    });\n    i0.ɵɵtext(17, \" Last \");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.visibleAlbums);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.getIterable(ctx_r1.totalPages));\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === ctx_r1.totalPages.length);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"disabled\", ctx_r1.currentPage === ctx_r1.totalPages.length);\n  }\n}\nexport let CollectionComponent = /*#__PURE__*/(() => {\n  class CollectionComponent {\n    constructor(collectionService, spotifyService) {\n      this.collectionService = collectionService;\n      this.spotifyService = spotifyService;\n      this.albums = [];\n      this.filteredAlbums = [];\n      this.searchControl = new FormControl('');\n      this.currentPage = 1;\n      this.itemsPerPage = 9;\n      this.collectionId = localStorage.getItem('collectionId');\n      this.loading = true;\n    }\n    ngOnInit() {\n      this.loadData();\n      this.searchControl.valueChanges.subscribe(searchTerm => {\n        this.filterAlbums(searchTerm);\n      });\n    }\n    loadData() {\n      this.loadCollection().subscribe(() => {\n        this.filteredAlbums = this.albums;\n        this.filterAlbums(this.searchControl.value);\n        this.loading = false; // Set loading to false after all albums are loaded\n      });\n    }\n\n    loadCollection() {\n      return this.collectionService.getCollection(this.collectionId).pipe(switchMap(collection => {\n        const albumIds = collection.albums.map(album => album.id);\n        const albumRequests = albumIds.map(albumId => this.spotifyService.getAlbum(albumId));\n        return forkJoin(albumRequests).pipe(tap(albums => {\n          this.albums = albums;\n        }));\n      }));\n    }\n    filterAlbums(searchTerm) {\n      const filtered = this.albums.filter(album => album.name.toLowerCase().includes(searchTerm.toLowerCase()) || album.artists.length > 0 && album.artists[0].name.toLowerCase().includes(searchTerm.toLowerCase()));\n      this.filteredAlbums = filtered;\n      this.currentPage = 1;\n    }\n    get totalPages() {\n      var totalPages = [];\n      const totalAlbums = Math.ceil(this.albums.length / this.itemsPerPage);\n      totalPages = Array(totalAlbums).fill(0).map((_, index) => index + 1);\n      return totalPages;\n    }\n    get visibleAlbums() {\n      const startIndex = (this.currentPage - 1) * this.itemsPerPage;\n      return this.filteredAlbums.slice(startIndex, startIndex + this.itemsPerPage);\n    }\n    setCurrentPage(page) {\n      if (page >= 1 && page <= this.totalPages.length) {\n        this.currentPage = page;\n      }\n    }\n    getIterable(value) {\n      return Array.isArray(value) ? value : Array.from({\n        length: value\n      });\n    }\n  }\n  CollectionComponent.ɵfac = function CollectionComponent_Factory(t) {\n    return new (t || CollectionComponent)(i0.ɵɵdirectiveInject(i1.CollectionService), i0.ɵɵdirectiveInject(i2.SpotifyService));\n  };\n  CollectionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CollectionComponent,\n    selectors: [[\"app-collection\"]],\n    decls: 5,\n    vars: 3,\n    consts: [[1, \"container\", \"mx-auto\"], [1, \"mb-4\"], [\"type\", \"text\", \"placeholder\", \"Search albums\", 1, \"w-full\", \"px-4\", \"py-2\", \"border\", \"rounded-md\", 3, \"formControl\"], [4, \"ngIf\"], [1, \"flex\", \"flex-col\", \"items-center\", \"justify-center\", \"h-64\"], [1, \"text-2xl\", \"font-bold\"], [1, \"text-gray-500\"], [1, \"grid\", \"grid-cols-1\", \"sm:grid-cols-2\", \"md:grid-cols-3\", \"gap-4\"], [\"class\", \"flex flex-col\", 4, \"ngFor\", \"ngForOf\"], [1, \"mt-4\"], [1, \"flex\", \"justify-center\", \"space-x-2\"], [1, \"btn-pagination\", 3, \"click\"], [3, \"active\", 4, \"ngFor\", \"ngForOf\"], [1, \"flex\", \"flex-col\"], [3, \"album\"]],\n    template: function CollectionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"input\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, CollectionComponent_ng_container_3_Template, 6, 0, \"ng-container\", 3);\n        i0.ɵɵtemplate(4, CollectionComponent_ng_container_4_Template, 18, 10, \"ng-container\", 3);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formControl\", ctx.searchControl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.visibleAlbums.length == 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.visibleAlbums.length != 0);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.DefaultValueAccessor, i4.NgControlStatus, i4.FormControlDirective, i5.FullAlbumComponent],\n    styles: [\".btn-pagination[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:#4a5568;color:#fff;border:none;border-radius:.25rem;cursor:pointer;transition:background-color .3s}.btn-pagination[_ngcontent-%COMP%]:hover{background-color:#718096}.btn-pagination.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.btn-pagination.active[_ngcontent-%COMP%]{background-color:#2c5282}\"]\n  });\n  return CollectionComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}